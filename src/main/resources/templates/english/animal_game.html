<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å‹•ç‰©è‹±æ–‡éŠæˆ²</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .animal-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .animal-card {
            height: 180px;
            /* Fixed height for consistency */
            padding: 1rem;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 5rem;
            /* For Emojis */
            overflow: hidden;
        }

        .animal-card:hover {
            transform: scale(1.05);
            background-color: var(--accent-color);
        }

        .animal-card img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
    </style>
</head>

<body>
    <header>
        <h1>å‹•ç‰©è‹±æ–‡éŠæˆ²</h1>
    </header>
    <main>
        <div th:replace="~{fragments :: nav('/english/menu', 'ä¸Šä¸€é ')}"></div>
        <div class="game-area">
            <div class="question" id="question">è«‹æ‰¾å‡ºï¼š?</div>
            <div class="animal-grid" id="options">
                <!-- Options generated by JS -->
            </div>
            <div id="result" style="font-size: 2rem; margin-top: 1rem; min-height: 3rem;"></div>
            <button class="btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
        </div>
    </main>
    <script th:src="@{/js/script.js}"></script>
    <script>
        const animals = [
            { name: 'Cat', emoji: 'ğŸ±', zh: 'è²“å’ª' },
            { name: 'Dog', emoji: 'ğŸ¶', zh: 'ç‹—ç‹—' },
            { name: 'Elephant', emoji: 'ğŸ˜', zh: 'å¤§è±¡' },
            { name: 'Lion', emoji: 'ğŸ¦', zh: 'ç…å­' },
            { name: 'Tiger', emoji: 'ğŸ¯', zh: 'è€è™' },
            { name: 'Monkey', emoji: 'ğŸµ', zh: 'çŒ´å­' },
            { name: 'Bee', emoji: 'ğŸ', zh: 'èœœèœ‚' },
            { name: 'Butterfly', emoji: 'ğŸ¦‹', zh: 'è´è¶' },
            { name: 'Ant', emoji: 'ğŸœ', zh: 'èèŸ»' },
            { name: 'Fish', emoji: 'ğŸŸ', zh: 'é­š' },
            { name: 'Bird', emoji: 'ğŸ¦', zh: 'å°é³¥' },
            { name: 'Rabbit', emoji: 'ğŸ°', zh: 'å…”å­' },
            { name: 'Giraffe', emoji: 'ğŸ¦’', zh: 'é•·é ¸é¹¿' },
            { name: 'Rhinoceros', emoji: 'ğŸ¦', zh: 'çŠ€ç‰›' },
            { name: 'Hippo', emoji: 'ğŸ¦›', zh: 'æ²³é¦¬' },
            { name: 'Ladybug', emoji: 'ğŸ', zh: 'ç“¢èŸ²' },
            { name: 'Caterpillar', emoji: 'ğŸ›', zh: 'æ¯›æ¯›èŸ²' },
            { name: 'Panda', emoji: 'ğŸ¼', zh: 'è²“ç†Š' },
            { name: 'Spider', emoji: 'ğŸ•·ï¸', zh: 'èœ˜è››' },
            { name: 'Dragonfly', image: '/images/dragonfly.png', zh: 'èœ»èœ“' }
        ];

        let currentAnswer = null;

        function nextQuestion() {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = '';

            // Pick random answer
            currentAnswer = animals[Math.floor(Math.random() * animals.length)];

            document.getElementById('question').textContent = `è«‹æ‰¾å‡ºï¼š${currentAnswer.name}`;

            // Speak: "Please find [Animal Name]"
            speak(`Please find the ${currentAnswer.name}`, 'en-US');

            // Generate 4 options including answer
            const options = [currentAnswer];
            while (options.length < 4) {
                const r = animals[Math.floor(Math.random() * animals.length)];
                if (!options.includes(r)) options.push(r);
            }
            // Shuffle
            options.sort(() => Math.random() - 0.5);

            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = '';
            options.forEach(animal => {
                const div = document.createElement('div');
                div.className = 'animal-card';

                if (animal.image) {
                    const img = document.createElement('img');
                    img.src = animal.image;
                    div.appendChild(img);
                } else {
                    div.textContent = animal.emoji;
                }

                div.onclick = () => checkAnswer(animal);
                optionsDiv.appendChild(div);
            });
        }

        function checkAnswer(animal) {
            const resultDiv = document.getElementById('result');
            if (animal === currentAnswer) {
                resultDiv.textContent = 'Correct! ç­”å°äº†ï¼';
                resultDiv.style.color = 'green';
                speak('Correct!', 'en-US');
                setTimeout(nextQuestion, 2000);
            } else {
                resultDiv.textContent = 'Try Again! å†è©¦ä¸€æ¬¡ï¼';
                resultDiv.style.color = 'red';
                speak('Try Again', 'en-US');
            }
        }

        window.onload = function () {
            playGameSound('Welcome to the Animal Game!', 'en-US');
            setTimeout(nextQuestion, 1500);
        };

        function playGameSound(text, lang = 'en-US') {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = lang;
                utterance.rate = 0.9;
                utterance.pitch = 1.2;
                speechSynthesis.speak(utterance);
            }
        }
    </script>
</body>

</html>