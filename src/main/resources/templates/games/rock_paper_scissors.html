<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å‰ªåˆ€çŸ³é ­å¸ƒ - å¿«æ¨‚å­¸ç¿’æ¨‚åœ’</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .game-container {
            text-align: center;
            margin-top: 20px;
            padding: 0 10px;
        }

        .battle-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .player-side,
        .computer-side {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .player-label {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4ECDC4;
            margin-bottom: 10px;
        }

        .computer-label {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FF6B6B;
            margin-bottom: 10px;
        }

        .choice-display {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(145deg, #f0f0f0, #cacaca);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 4rem;
            box-shadow: 5px 5px 15px #bebebe, -5px -5px 15px #ffffff;
            transition: all 0.3s ease;
        }

        .choice-display.waiting {
            font-size: 2rem;
            color: #999;
        }

        .vs-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: #FFE66D;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .choices-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .choice-btn {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: none;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            background: white;
        }

        .choice-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
        }

        .choice-btn:active {
            transform: scale(0.95);
        }

        .choice-btn.rock {
            background: linear-gradient(145deg, #ffecd2, #fcb69f);
        }

        .choice-btn.scissors {
            background: linear-gradient(145deg, #a1c4fd, #c2e9fb);
        }

        .choice-btn.paper {
            background: linear-gradient(145deg, #d4fc79, #96e6a1);
        }

        .choice-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .result-message {
            font-size: 2rem;
            font-weight: bold;
            margin: 20px 0;
            min-height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .btn-restart {
            background: linear-gradient(145deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.3rem;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
            transition: all 0.3s ease;
        }

        .btn-restart:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.5);
        }

        .hidden {
            display: none !important;
        }

        /* å‹•ç•«æ•ˆæœ */
        @keyframes pop-in {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes winner-pulse {

            0%,
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
            }

            50% {
                transform: scale(1.1);
                box-shadow: 0 0 30px 10px rgba(255, 215, 0, 0.5);
            }
        }

        @keyframes loser-shake {

            0%,
            100% {
                transform: translateX(0);
            }

            20%,
            60% {
                transform: translateX(-8px);
            }

            40%,
            80% {
                transform: translateX(8px);
            }
        }

        @keyframes draw-bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-15px);
            }
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100%) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes rainbow-bg {
            0% {
                background-color: #ff9a9e;
            }

            25% {
                background-color: #fad0c4;
            }

            50% {
                background-color: #a1c4fd;
            }

            75% {
                background-color: #c2e9fb;
            }

            100% {
                background-color: #ff9a9e;
            }
        }

        @keyframes star-spin {
            0% {
                transform: rotate(0deg) scale(0);
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                transform: rotate(360deg) scale(1);
                opacity: 0;
            }
        }

        .choice-display.pop-in {
            animation: pop-in 0.5s ease-out;
        }

        .choice-display.winner {
            animation: winner-pulse 0.6s ease-in-out infinite;
            background: linear-gradient(145deg, #FFD700, #FFA500);
        }

        .choice-display.loser {
            animation: loser-shake 0.5s ease-in-out;
            filter: grayscale(50%);
        }

        .choice-display.draw {
            animation: draw-bounce 0.5s ease-in-out infinite;
            background: linear-gradient(145deg, #E0E0E0, #BDBDBD);
        }

        .result-message.win {
            color: #4CAF50;
            animation: pop-in 0.5s ease-out;
        }

        .result-message.lose {
            color: #F44336;
            animation: loser-shake 0.5s ease-in-out;
        }

        .result-message.draw {
            color: #FF9800;
            animation: draw-bounce 0.6s ease-in-out 3;
        }

        /* æ…¶ç¥æ•ˆæœ */
        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            top: -20px;
            animation: confetti-fall 3s linear forwards;
        }

        .star-burst {
            position: fixed;
            font-size: 2rem;
            animation: star-spin 1s ease-out forwards;
            pointer-events: none;
            z-index: 101;
        }

        /* éŠæˆ²èƒŒæ™¯æ•ˆæœ */
        .game-container.win-bg {
            animation: rainbow-bg 2s ease-in-out;
            border-radius: 20px;
        }

        /* èªªæ˜æ–‡å­— */
        .instruction {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 20px;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 480px) {
            .choice-display {
                width: 90px;
                height: 90px;
                font-size: 3rem;
            }

            .choice-btn {
                width: 80px;
                height: 80px;
                font-size: 2.5rem;
            }

            .vs-text {
                font-size: 1.8rem;
            }

            .player-label,
            .computer-label {
                font-size: 1.2rem;
            }

            .result-message {
                font-size: 1.5rem;
            }

            .battle-area {
                gap: 15px;
            }

            .choices-container {
                gap: 15px;
            }

            .instruction {
                font-size: 1.1rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>âœŠ å‰ªåˆ€çŸ³é ­å¸ƒ âœŒï¸</h1>
    </header>
    <main>
        <div class="nav-container">
            <a href="/games/menu" class="nav-link">â† å›ä¸Šä¸€é </a>
            <a href="/" class="nav-link home-link">ğŸ  å›é¦–é </a>
        </div>
        <div class="game-container" id="game-container">
            <div class="instruction">é¸æ“‡ä½ è¦å‡ºçš„æ‹³ï¼</div>

            <div class="battle-area">
                <div class="player-side">
                    <div class="player-label">ğŸ‘¤ ä½ </div>
                    <div class="choice-display waiting" id="player-choice">?</div>
                </div>

                <div class="vs-text">VS</div>

                <div class="computer-side">
                    <div class="computer-label">ğŸ¤– é›»è…¦</div>
                    <div class="choice-display waiting" id="computer-choice">?</div>
                </div>
            </div>

            <div class="choices-container" id="choices-container">
                <button class="choice-btn rock" onclick="play('rock')" title="çŸ³é ­">âœŠ</button>
                <button class="choice-btn scissors" onclick="play('scissors')" title="å‰ªåˆ€">âœŒï¸</button>
                <button class="choice-btn paper" onclick="play('paper')" title="å¸ƒ">ğŸ–ï¸</button>
            </div>

            <div class="result-message" id="result-message"></div>

            <button class="btn-restart hidden" id="restart-btn" onclick="resetGame()">å†ç©ä¸€æ¬¡ ğŸ”„</button>
        </div>

        <div class="celebration hidden" id="celebration"></div>
    </main>

    <script>
        const choices = {
            rock: 'âœŠ',
            scissors: 'âœŒï¸',
            paper: 'ğŸ–ï¸'
        };

        const choiceNames = {
            rock: 'çŸ³é ­',
            scissors: 'å‰ªåˆ€',
            paper: 'å¸ƒ'
        };

        // å‹è² åˆ¤å®š: è¿”å› 'win', 'lose', 'draw'
        function getResult(player, computer) {
            if (player === computer) return 'draw';
            if (
                (player === 'rock' && computer === 'scissors') ||
                (player === 'scissors' && computer === 'paper') ||
                (player === 'paper' && computer === 'rock')
            ) {
                return 'win';
            }
            return 'lose';
        }

        // é›»è…¦éš¨æ©Ÿå‡ºæ‹³
        function getComputerChoice() {
            const options = ['rock', 'scissors', 'paper'];
            return options[Math.floor(Math.random() * options.length)];
        }

        // éŠæˆ²ä¸»é‚è¼¯
        function play(playerChoice) {
            const computerChoice = getComputerChoice();
            const result = getResult(playerChoice, computerChoice);

            // ç¦ç”¨æŒ‰éˆ•
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(btn => btn.disabled = true);

            // é¡¯ç¤ºé¸æ“‡
            const playerDisplay = document.getElementById('player-choice');
            const computerDisplay = document.getElementById('computer-choice');

            playerDisplay.textContent = choices[playerChoice];
            playerDisplay.classList.remove('waiting');
            playerDisplay.classList.add('pop-in');

            // å»¶é²é¡¯ç¤ºé›»è…¦é¸æ“‡ï¼Œè£½é€ æ‡¸å¿µ
            setTimeout(() => {
                computerDisplay.textContent = choices[computerChoice];
                computerDisplay.classList.remove('waiting');
                computerDisplay.classList.add('pop-in');

                // é¡¯ç¤ºçµæœ
                setTimeout(() => {
                    showResult(result, playerDisplay, computerDisplay);
                }, 300);
            }, 500);
        }

        // é¡¯ç¤ºçµæœå‹•ç•«
        function showResult(result, playerDisplay, computerDisplay) {
            const resultMessage = document.getElementById('result-message');
            const restartBtn = document.getElementById('restart-btn');
            const gameContainer = document.getElementById('game-container');

            // ç§»é™¤ä¹‹å‰çš„å‹•ç•«é¡åˆ¥
            playerDisplay.classList.remove('pop-in', 'winner', 'loser', 'draw');
            computerDisplay.classList.remove('pop-in', 'winner', 'loser', 'draw');
            resultMessage.classList.remove('win', 'lose', 'draw');
            gameContainer.classList.remove('win-bg');

            if (result === 'win') {
                playerDisplay.classList.add('winner');
                computerDisplay.classList.add('loser');
                resultMessage.innerHTML = 'ğŸ‰ ä½ è´äº†ï¼å¤ªæ£’äº†ï¼ ğŸ‰';
                resultMessage.classList.add('win');
                gameContainer.classList.add('win-bg');
                createCelebration();
            } else if (result === 'lose') {
                playerDisplay.classList.add('loser');
                computerDisplay.classList.add('winner');
                resultMessage.innerHTML = 'ğŸ˜¢ ä½ è¼¸äº†ï¼å†è©¦ä¸€æ¬¡ï¼ ğŸ’ª';
                resultMessage.classList.add('lose');
            } else {
                playerDisplay.classList.add('draw');
                computerDisplay.classList.add('draw');
                resultMessage.innerHTML = 'ğŸ¤ å¹³æ‰‹ï¼å†ä¾†ä¸€å±€ï¼ ğŸ¤';
                resultMessage.classList.add('draw');
            }

            restartBtn.classList.remove('hidden');
        }

        // å»ºç«‹æ…¶ç¥æ•ˆæœï¼ˆå½©å¸¶ + æ˜Ÿæ˜Ÿï¼‰
        function createCelebration() {
            const celebration = document.getElementById('celebration');
            celebration.classList.remove('hidden');
            celebration.innerHTML = '';

            // å»ºç«‹å½©å¸¶
            const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#95E1D3', '#F38181', '#AA96DA'];
            for (let i = 0; i < 30; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                celebration.appendChild(confetti);
            }

            // å»ºç«‹æ˜Ÿæ˜Ÿ
            const starEmojis = ['â­', 'ğŸŒŸ', 'âœ¨', 'ğŸ’«'];
            for (let i = 0; i < 10; i++) {
                const star = document.createElement('div');
                star.className = 'star-burst';
                star.textContent = starEmojis[Math.floor(Math.random() * starEmojis.length)];
                star.style.left = Math.random() * 80 + 10 + '%';
                star.style.top = Math.random() * 60 + 20 + '%';
                star.style.animationDelay = Math.random() * 0.5 + 's';
                document.body.appendChild(star);

                setTimeout(() => star.remove(), 1500);
            }

            // æ¸…é™¤æ…¶ç¥æ•ˆæœ
            setTimeout(() => {
                celebration.classList.add('hidden');
            }, 3000);
        }

        // é‡ç½®éŠæˆ²
        function resetGame() {
            const playerDisplay = document.getElementById('player-choice');
            const computerDisplay = document.getElementById('computer-choice');
            const resultMessage = document.getElementById('result-message');
            const restartBtn = document.getElementById('restart-btn');
            const gameContainer = document.getElementById('game-container');
            const buttons = document.querySelectorAll('.choice-btn');

            // é‡ç½®é¡¯ç¤º
            playerDisplay.textContent = '?';
            playerDisplay.className = 'choice-display waiting';
            computerDisplay.textContent = '?';
            computerDisplay.className = 'choice-display waiting';

            // æ¸…é™¤çµæœè¨Šæ¯
            resultMessage.innerHTML = '';
            resultMessage.className = 'result-message';

            // éš±è—é‡æ–°é–‹å§‹æŒ‰éˆ•
            restartBtn.classList.add('hidden');

            // ç§»é™¤èƒŒæ™¯æ•ˆæœ
            gameContainer.classList.remove('win-bg');

            // å•Ÿç”¨æŒ‰éˆ•
            buttons.forEach(btn => btn.disabled = false);
        }
    </script>
</body>

</html>